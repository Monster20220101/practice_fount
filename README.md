# 实训云手机端（后端）

## 基本介绍

这是“实训云手机端”项目的后端，是大二的在校实训作业。

它是通过SpringBoot+Vue来模拟实训云网站的手机端APP（但代码实现本身并不是APP而是网站），前后端分离，采用了Shiro整合Redis，是一个学习项目。

> 关于实训云：是我校教辅平台，用于交实训作业



## 安装

- 本项目使用的JAVA版本为`1.8.0_121`，Nodejs版本`v16.14.2`

- 需要自行安装redis

- 导入数据库文件 [](practice.sql)并在[](src/main/resources/application.yml)中修改数据库密码

- 前端部分 [Monster20220101/practice_fount](https://github.com/Monster20220101/practice_fount) 需要安装Node的依赖模块（node_modules)：在前端项目的终端输入`npm install`



## 运行

- 运行项目前要先打开redis

- 后端部分：在IDEA中运行application类启动项目

- 前端部分：前端项目的终端输入 `npm run dev` 运行项目。在浏览器按`F12`打开控制台，`Ctrl+Shift+M`开启设备仿真，可以选择iPhone SE等尺寸



## 技术栈介绍

### 1. 后端技术栈：

- 框架：springboot

- 数据层：mybatis-plus

- 权限框架：shiro

- 缓存：redis

- 用户身份凭证：jwt

### 2. 前端技术栈：

- vue2
- vant组件库
- axios

### 3. 数据库：

MySQL

- id采用雪花算法
- 数据库自动填充字段create_time和update_time



## 项目模块

![image-20240405212834447](.assets/README/image-20240405212834447.png)

### （一）用户模块

![image-20240405211801705](.assets/README/image-20240405211801705.png)

![image-20240405211829371](.assets/README/image-20240405211829371.png)

- 后端配置：
  - 全局异常拦截处理
  - 接口统一返回类Result
  - 本地文件映射路径
  - 全局跨域配置
  - mybatis-plus分页配置、代码生成器配置、代码自动生成
- 权限拦截：
  - 后端：采用shiro-redis框架
  - 前端：permission.js 全局登录拦截
- 用户登录、注册、退出
- 用户信息查看、用户头像修改、密码修改、用户手机号修改

> 注册、修改手机号：前后端都做了数据校验



备注一下shiro官网的demo（但本项目shiro+redis+jwt很多于shiro内置的用法不同，仅供参考）：

图一：![image-20221201195228427](.assets/README/image-20221201195228427.png)

图二：![image-20221201195242135](.assets/README/image-20221201195242135.png)

图三：![image-20221201195250345](.assets/README/image-20221201195250345.png)



### （二）班级模块

> 班级管理仅教师端

![image-20240405212901966](.assets/README/image-20240405212901966.png)

- 添加班级：关联教师id

- 更新班级：只能更新自己的班级，只能操作没删除的字段

- 删除班级：只能删除自己的班级，只能操作没删除的字段

- 查看班级：只能查看自己的班级，只能查看没删除的字段

可以分页，也可以不分页：传入page参数就分页，没传就不分页

最后返回班级列表数据给前端

### （三）学生模块

> 学生模块仅教师端

- 添加学生

  如果学生学号小于等于6位，学生登录密码等于学号；
  如果大于6位，学生登录密码等于学号后六位。

  密码是加密后存入数据库的。

- 更新学生

- 删除学生：假删

- 查看学生

  分班级查询：relationClassId

  搜索：模糊查询。分页



### （四）任务模块

#### A. 教师端

![image-20240405213546326](.assets/README/image-20240405213546326.png)

1. 添加任务

     字段为空无法添加

     开始时间无法晚于结束时间

     自动判断并更新任务状态

     添加任务时给该班级所有学生添加一个0分

2. 更新任务

     同上的前三行

3. 删除任务

     假删

4. 查看任务列表

     分班级查询：relationClassId

     搜索：模糊查询

     分页

5. 查看任务细节和平均分

     xml里计算平均分

6. 查看打分列表

   搜索：模糊查询

   分页

7. 打分



#### B. 学生端

- （同上）查看任务列表

- （类上）查看任务细节和自己分数



#### C. 定时任务：更新任务状态

根据当前时间、任务开始时间、任务结束时间，来自动判断任务状态并更新

每分钟更新1次



### （五）资源模块

1. 上传（仅教师端）

   调用工具类，上传后将文件路径（本地映射路径）和其它信息存入数据库

   > 文件位置：D:/practice/resourceInfo

2. 下载

   老师给的工具类ImgsInfoController -> getFile

3. 删除（仅教师端）

   只能删除自己上传的

   只能操作没删除的字段

4. 查看列表

   （教师端）分班级查询：relationClassId

   搜索：模糊查询

   分页

5. 预览图片（纯前端）



### （六）日报模块

1. 添加（学生）

   前端：字数限制

2. 更新

   - 学生端：更新日报

   - 教师端：打分

   后端使用同一个接口，后端判断用户身份再执行对应操作

3. 删除（学生）

4. 查看列表

   （教师端）分班级查询：relationClassId

   搜索：模糊查询

   分页



### （七）视频模块

![image-20240405213639254](.assets/README/image-20240405213639254.png)

1. 上传（仅学生端）

   调用工具类，上传后将文件路径（本地映射路径）和其它信息存入数据库

   > 文件位置：D:/practice/videoInfo

2. 下载

   老师给的工具类ImgsInfoController -> getFile

3. 删除（仅学生端）

   只能删除自己上传的

   只能操作没删除的字段

4. 查看列表

   （教师端）分班级查询：relationClassId

   搜索：模糊查询

   分页

5. 预览视频（纯前端）



### （八）答疑模块

![image-20240405211859551](.assets/README/image-20240405211859551.png)

![image-20240405211936841](.assets/README/image-20240405211936841.png)

![image-20240405212742923](.assets/README/image-20240405212742923.png)

- 查看答疑列表：上拉刷新，下拉加载，教师可分班级查看。查看答疑评论列表。图片预览。
- 发表答疑与答疑评论：可上传多张图片，内容为空或关联班级为空时无法发表，发布答疑评论时自动打开该评论列表。
- 删除答疑：删除答疑评论后自动刷新该评论列表。



## 前端相关

- request.js 请求拦截处理，处理jwtToken用户令牌
- premision.js 用户权限拦截
- store数据仓库处理
- 前端css美化、移动端手势互动、404页面

